<div class="edit-container">
    <!-- Breadcrumb Navigation -->
    <nav class="breadcrumb-nav">
        <a routerLink="/custom-barcodes">
            <mat-icon>qr_code</mat-icon> Custom QR Codes
        </a>
        <span class="breadcrumb-separator">›</span>
        <span class="breadcrumb-current">{{ isNew ? 'Create Barcode' : (title || 'Edit Barcode') }}</span>
    </nav>

    <h1>{{ isNew ? 'Create Barcode' : 'Edit Barcode' }}</h1>

    <div class="form-grid">
        <mat-form-field appearance="fill">
            <mat-label>Title</mat-label>
            <input matInput [(ngModel)]="title" placeholder="e.g. Kitchen Lights Toggle">
        </mat-form-field>

        <mat-form-field appearance="fill">
            <mat-label>Barcode Data</mat-label>
            <textarea matInput [(ngModel)]="data" rows="4" required class="mono-input"
                placeholder="Enter the data payload for this barcode"></textarea>
            <mat-hint>This will be encoded as a QR code with the HA: prefix</mat-hint>
        </mat-form-field>
    </div>

    <div class="preview" *ngIf="fullBarcodePreview">
        <h3>Full Barcode Value</h3>
        <div class="preview-value">{{ fullBarcodePreview }}</div>
    </div>

    <div class="actions">
        <button mat-raised-button color="primary" (click)="save()" [disabled]="!data.trim() || saving || isDeleting">
            <mat-spinner *ngIf="saving" [diameter]="20" class="btn-spinner-inline"></mat-spinner>
            <mat-icon *ngIf="!saving">save</mat-icon>
            {{ saving ? 'Saving…' : 'Save' }}
        </button>
        <button mat-button routerLink="/custom-barcodes">Cancel</button>
        <button mat-button color="warn" *ngIf="!isNew" (click)="delete()" [disabled]="isDeleting || saving">
            <mat-spinner *ngIf="isDeleting" [diameter]="20" class="btn-spinner-inline"></mat-spinner>
            <mat-icon *ngIf="!isDeleting">delete</mat-icon>
            {{ isDeleting ? 'Deleting…' : 'Delete' }}
        </button>
    </div>

    <div class="print-section" *ngIf="!isNew">
        <h3>Print</h3>
        <div class="print-actions">
            <button mat-stroked-button (click)="printReceipt()" [disabled]="printing">
                <mat-icon>receipt_long</mat-icon> Print Receipt
            </button>
            <button mat-stroked-button (click)="printLabel()" [disabled]="printing">
                <mat-icon>label</mat-icon> Print Label
            </button>
        </div>
    </div>
</div>