<div class="photo-upload-container">
  <mat-progress-spinner *ngIf="isLoading" mode="indeterminate"></mat-progress-spinner>
  <div *ngIf="!capturedImage && !isLoading">
    <video #videoElement autoplay playsinline [hidden]="fileSelected"></video>
    <div class="button-row">
      <button mat-raised-button color="primary" (click)="startCamera()" *ngIf="!isCameraOn && !fileSelected">Start Camera</button>
      <button mat-raised-button color="accent" (click)="captureImage()" *ngIf="isCameraOn">Capture</button>
      <button mat-raised-button (click)="switchCamera()" *ngIf="isCameraOn && cameras.length > 1">Switch Camera</button>
      <input type="file" #fileInput (change)="onFileSelected($event)" accept="image/*" style="display: none;">
      <button mat-raised-button (click)="fileInput.click()" *ngIf="!isCameraOn">Select File</button>
    </div>
  </div>

  <div *ngIf="capturedImage && !isLoading">
    <img [src]="capturedImage" alt="Captured product image" class="captured-image">
    <div class="button-row">
      <button mat-raised-button (click)="retake()">Retake</button>
      <button mat-raised-button color="primary" (click)="uploadImage()">Upload</button>
    </div>
  </div>

  <canvas #canvasElement style="display: none;"></canvas>
</div>
