<div class="dashboard-container">
    <header class="dashboard-header fadeInDown">
        <div class="header-content">
            <span class="date-badge">{{ currentDate | date:'fullDate' }}</span>
            <h1>{{ getGreeting() }}</h1>
            <p class="subtitle">Here's your pantry overview</p>
        </div>
    </header>

    <div class="dashboard-grid">
        <!-- Main Stats Area -->
        <section class="stats-section fadeInUp" style="animation-delay: 0.1s">
            <div class="stat-card primary-stat">
                <div class="stat-icon">
                    <mat-icon>inventory_2</mat-icon>
                </div>
                <div class="stat-info">
                    <span class="stat-value">{{ totalProducts }}</span>
                    <span class="stat-label">Total Items</span>
                </div>
            </div>

            <div class="stat-card secondary-stat">
                <div class="stat-icon">
                    <mat-icon>category</mat-icon>
                </div>
                <div class="stat-info">
                    <span class="stat-value">{{ totalStock }}</span>
                    <span class="stat-label">Total Units</span>
                </div>
            </div>

            <div class="stat-card warn-stat" *ngIf="expiringProducts.length > 0">
                <div class="stat-icon">
                    <mat-icon>timer</mat-icon>
                </div>
                <div class="stat-info">
                    <span class="stat-value">{{ expiringProducts.length }}</span>
                    <span class="stat-label">Expiring Soon</span>
                </div>
            </div>
        </section>

        <!-- Quick Actions Grid -->
        <section class="actions-section fadeInUp" style="animation-delay: 0.2s">
            <h2>Quick Actions</h2>
            <div class="actions-grid">
                <a mat-ripple [routerLink]="['/barcode/scanner']" class="action-tile primary-action">
                    <mat-icon>qr_code_scanner</mat-icon>
                    <span>Scan Item</span>
                </a>
                <a mat-ripple [routerLink]="['/products/create']" class="action-tile accent-action">
                    <mat-icon>add_circle</mat-icon>
                    <span>Add Product</span>
                </a>
                <a mat-ripple [routerLink]="['/shopping-list']" class="action-tile">
                    <mat-icon>shopping_cart</mat-icon>
                    <span>Shop List</span>
                </a>
                <button mat-ripple (click)="openQuickSnack()" class="action-tile">
                    <mat-icon>lunch_dining</mat-icon>
                    <span>Quick Snack</span>
                </button>
                <a mat-ripple [routerLink]="['/products']" class="action-tile">
                    <mat-icon>list_alt</mat-icon>
                    <span>All Items</span>
                </a>
                <a mat-ripple [routerLink]="['/meal-plan']" class="action-tile">
                    <mat-icon>calendar_month</mat-icon>
                    <span>Meal Plan</span>
                </a>
            </div>
        </section>

        <!-- Widgets Row -->
        <div class="widgets-row fadeInUp" style="animation-delay: 0.3s">
            <!-- Left Column: Upcoming Tasks -->
            <div class="widget-column">
                <app-upcoming-tasks-widget></app-upcoming-tasks-widget>
            </div>

            <!-- Right Column: Expiring & Recent -->
            <div class="widget-column">
                <section class="list-widget" *ngIf="leftoverProducts.length > 0">
                    <div class="widget-header">
                        <h3>
                            <mat-icon style="vertical-align: middle; margin-right: 8px;">takeout_dining</mat-icon>
                            Leftovers
                        </h3>
                    </div>
                    <div class="compact-list">
                        <div *ngFor="let product of leftoverProducts" class="compact-item"
                            [routerLink]="['/products', product.id]" mat-ripple>
                            <div class="item-img">
                                <img [src]="getImageUrl(product)" *ngIf="getImageUrl(product)" loading="lazy"
                                    alt="{{product.title}}">
                                <div class="icon-placeholder" *ngIf="!getImageUrl(product)">
                                    <mat-icon>takeout_dining</mat-icon>
                                </div>
                            </div>
                            <div class="item-details">
                                <span class="item-title">{{ product.title }}</span>
                                <span class="item-subtitle expires">Expires {{ product.minExpiration | date:'mediumDate'
                                    }}</span>
                            </div>
                        </div>
                    </div>
                </section>

                <section class="list-widget" *ngIf="expiringProducts.length > 0">
                    <div class="widget-header">
                        <h3>Expiring Soon</h3>
                        <a mat-button color="warn" [routerLink]="['/products']">See All</a>
                    </div>
                    <div class="compact-list">
                        <div *ngFor="let product of expiringProducts" class="compact-item"
                            [routerLink]="['/products', product.id]" mat-ripple>
                            <div class="item-img">
                                <img [src]="getImageUrl(product)" *ngIf="getImageUrl(product)" loading="lazy"
                                    alt="{{product.title}}">
                                <div class="icon-placeholder" *ngIf="!getImageUrl(product)">
                                    <mat-icon>fastfood</mat-icon>
                                </div>
                            </div>
                            <div class="item-details">
                                <span class="item-title">{{ product.title }}</span>
                                <span class="item-subtitle expires">Expires {{ product.minExpiration | date:'mediumDate'
                                    }}</span>
                            </div>
                        </div>
                    </div>
                </section>

                <section class="list-widget">
                    <div class="widget-header">
                        <h3>Recently Added</h3>
                    </div>
                    <div class="horizontal-scroll-list">
                        <div *ngFor="let product of recentProducts" class="mini-card"
                            [routerLink]="['/products', product.id]" mat-ripple>
                            <div class="mini-card-img">
                                <img [src]="getImageUrl(product)" *ngIf="getImageUrl(product)" loading="lazy"
                                    alt="{{product.title}}">
                                <div class="icon-placeholder" *ngIf="!getImageUrl(product)">
                                    <mat-icon>inventory_2</mat-icon>
                                </div>
                            </div>
                            <span class="mini-card-title">{{ product.title }}</span>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>
</div>