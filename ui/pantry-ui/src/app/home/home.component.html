<div class="dashboard-container">
    <header class="dashboard-header">
        <div>
            <h1>{{ getGreeting() }}!</h1>
            <p class="subtitle">Here's what's happening in your pantry.</p>
        </div>
        <div class="header-decoration"></div>
    </header>

    <div class="stats-row">
        <mat-card class="stat-card">
            <mat-card-content>
                <div class="stat-value">{{ totalProducts }}</div>
                <div class="stat-label">Total Items</div>
            </mat-card-content>
        </mat-card>
        <mat-card class="stat-card">
            <mat-card-content>
                <div class="stat-value">{{ totalStock }}</div>
                <div class="stat-label">Total Quantity</div>
            </mat-card-content>
        </mat-card>
        <mat-card class="stat-card warn" *ngIf="expiringProducts.length > 0">
            <mat-card-content>
                <div class="stat-value">{{ expiringProducts.length }}</div>
                <div class="stat-label">Expiring Soon</div>
            </mat-card-content>
        </mat-card>
    </div>

    <section class="quick-actions">
        <h2>Quick Actions</h2>
        <div class="actions-grid">
            <a mat-raised-button color="primary" [routerLink]="['/barcode/scanner']" class="action-btn">
                <mat-icon>qr_code_scanner</mat-icon>
                <span>Scan Item</span>
            </a>
            <a mat-raised-button color="accent" [routerLink]="['/products/create']" class="action-btn">
                <mat-icon>add_circle</mat-icon>
                <span>Add Product</span>
            </a>
            <a mat-raised-button class="action-btn" [routerLink]="['/shopping-list']">
                <mat-icon>shopping_cart</mat-icon>
                <span>Shopping List</span>
            </a>
            <button mat-raised-button class="action-btn" (click)="openQuickSnack()">
                <mat-icon>lunch_dining</mat-icon>
                <span>Quick Snack</span>
            </button>
            <a mat-raised-button class="action-btn" [routerLink]="['/products']">
                <mat-icon>inventory_2</mat-icon>
                <span>All Products</span>
            </a>
        </div>
    </section>

    <div class="content-grid">
        <section class="widget-section">
            <app-upcoming-tasks-widget></app-upcoming-tasks-widget>
        </section>

        <section class="widget-section">
            <div class="section-header">
                <h2>Expiring Soon</h2>
                <a mat-button [routerLink]="['/products']">View All</a>
            </div>
            <div class="product-scroll-container">
                <mat-card *ngFor="let product of expiringProducts" class="product-card"
                    [routerLink]="['/products', product.id]">
                    <div class="card-image-wrapper">
                        <img [src]="getImageUrl(product)" *ngIf="getImageUrl(product)" alt="{{product.title}}">
                        <div class="no-image-placeholder" *ngIf="!getImageUrl(product)">
                            <mat-icon>fastfood</mat-icon>
                        </div>
                    </div>
                    <mat-card-content>
                        <h3 class="text-truncate">{{ product.title }}</h3>
                        <p class="expiry-date">Expires {{ product.minExpiration | date }}</p>
                    </mat-card-content>
                </mat-card>
                <div *ngIf="expiringProducts.length === 0" class="empty-state">
                    <mat-icon>check_circle</mat-icon>
                    <p>No items expiring soon!</p>
                </div>
            </div>
        </section>

        <section class="widget-section">
            <div class="section-header">
                <h2>Recently Added</h2>
            </div>
            <div class="product-scroll-container">
                <mat-card *ngFor="let product of recentProducts" class="product-card"
                    [routerLink]="['/products', product.id]">
                    <div class="card-image-wrapper">
                        <img [src]="getImageUrl(product)" *ngIf="getImageUrl(product)" alt="{{product.title}}">
                        <div class="no-image-placeholder" *ngIf="!getImageUrl(product)">
                            <mat-icon>inventory_2</mat-icon>
                        </div>
                    </div>
                    <mat-card-content>
                        <h3 class="text-truncate">{{ product.title }}</h3>
                        <p class="secondary-text">{{ product.totalQuantity }} in stock</p>
                    </mat-card-content>
                </mat-card>
            </div>
        </section>
    </div>
</div>