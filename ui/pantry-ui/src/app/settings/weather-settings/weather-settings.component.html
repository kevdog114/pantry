<div class="container">
    <div class="settings-card">
        <h3>Configuration</h3>
        <div class="form-grid">
            <mat-form-field appearance="outline">
                <mat-label>Weather Provider</mat-label>
                <mat-select [(ngModel)]="settings.provider">
                    <mat-option value="disabled">Disabled</mat-option>
                    <mat-option value="weather.gov">Weather.gov (NOAA)</mat-option>
                </mat-select>
            </mat-form-field>

            <ng-container *ngIf="settings.provider === 'weather.gov'">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                    <p style="margin: 0; color: #666; font-size: 0.9em;">
                        Enter your coordinates to fetch local weather data.
                    </p>
                    <button mat-stroked-button (click)="getBrowserLocation()" [disabled]="isLocating" type="button"
                        class="small-text-button">
                        <mat-icon
                            style="font-size: 18px; width: 18px; height: 18px; vertical-align: middle; margin-right: 4px;">my_location</mat-icon>
                        {{ isLocating ? 'Locating...' : 'Use Current Location' }}
                    </button>
                </div>
                <div style="display: flex; gap: 16px;">
                    <mat-form-field appearance="outline" style="flex: 1;">
                        <mat-label>Latitude</mat-label>
                        <input matInput [(ngModel)]="settings.lat" placeholder="e.g. 39.7456">
                    </mat-form-field>

                    <mat-form-field appearance="outline" style="flex: 1;">
                        <mat-label>Longitude</mat-label>
                        <input matInput [(ngModel)]="settings.lon" placeholder="e.g. -97.0892">
                    </mat-form-field>
                </div>
            </ng-container>

            <div class="actions" style="display: flex; justify-content: flex-end;">
                <button mat-flat-button color="primary" (click)="saveSettings()" [disabled]="isLoading">
                    {{ isLoading ? 'Saving...' : 'Save Configuration' }}
                </button>
            </div>
        </div>
    </div>

    <div class="forecast-section" *ngIf="forecast.length > 0">
        <h3>Current Forecast Data</h3>
        <table mat-table [dataSource]="forecast">

            <ng-container matColumnDef="date">
                <th mat-header-cell *matHeaderCellDef> Date </th>
                <td mat-cell *matCellDef="let element"> {{element.date | date:'EEE, MMM d'}} </td>
            </ng-container>

            <ng-container matColumnDef="high">
                <th mat-header-cell *matHeaderCellDef> High </th>
                <td mat-cell *matCellDef="let element"> {{element.highTemp}}° </td>
            </ng-container>

            <ng-container matColumnDef="low">
                <th mat-header-cell *matHeaderCellDef> Low </th>
                <td mat-cell *matCellDef="let element"> {{element.lowTemp}}° </td>
            </ng-container>

            <ng-container matColumnDef="condition">
                <th mat-header-cell *matHeaderCellDef> Condition </th>
                <td mat-cell *matCellDef="let element"> {{element.condition}} </td>
            </ng-container>

            <ng-container matColumnDef="precip">
                <th mat-header-cell *matHeaderCellDef> Precip </th>
                <td mat-cell *matCellDef="let element"> {{element.precipitationChance}}% </td>
            </ng-container>

            <ng-container matColumnDef="updated">
                <th mat-header-cell *matHeaderCellDef> Last Updated </th>
                <td mat-cell *matCellDef="let element"> {{element.updatedAt | date:'shortTime'}} </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
    </div>
</div>