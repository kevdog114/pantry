[supervisord]
nodaemon=true
logfile=/var/log/supervisord.log
pidfile=/var/run/supervisord.pid

[program:xvnc]
command=/usr/bin/Xvnc :99 -geometry %(ENV_SCREEN_WIDTH)sx%(ENV_SCREEN_HEIGHT)s -depth %(ENV_SCREEN_DEPTH)s -rfbport %(ENV_VNC_PORT)s -SecurityTypes None -AlwaysShared -AcceptKeyEvents -AcceptPointerEvents -AcceptSetDesktopSize -SendCutText -AcceptCutText
autorestart=true
priority=100
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0

[program:fluxbox]
command=/usr/bin/fluxbox
environment=DISPLAY=":99"
autorestart=true
priority=200
startsecs=5
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0

[program:websockify]
command=/usr/local/bin/websockify --web /opt/novnc 0.0.0.0:%(ENV_NOVNC_PORT)s 127.0.0.1:%(ENV_VNC_PORT)s
autorestart=true
priority=400
startsecs=5
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0

[program:playwright-mcp]
command=npx @playwright/mcp@latest --port 8932 --browser chromium
environment=DISPLAY=":99"
autorestart=true
priority=500
startsecs=10
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0

[program:mcp-forwarder]
command=/usr/bin/socat TCP-LISTEN:8931,fork,reuseaddr TCP:127.0.0.1:8932
autorestart=true
priority=600
startsecs=5
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
